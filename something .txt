import org.testcontainers.containers.GenericContainer;
import org.testcontainers.containers.Network;

public class MailhogContainerExample {
    public static void main(String[] args) {
        // Define a network for the container
        Network network = Network.newNetwork();

        // Create a Mailhog container
        GenericContainer<?> mailhogContainer = new GenericContainer<>("mailhog/mailhog")
                .withExposedPorts(1025, 8025) // Expose SMTP and HTTP ports
                .withNetwork(network);

        // Start the container
        mailhogContainer.start();

        // Get the container's host and port for SMTP and HTTP
        String smtpHost = mailhogContainer.getContainerIpAddress();
        Integer smtpPort = mailhogContainer.getMappedPort(1025);
        Integer httpPort = mailhogContainer.getMappedPort(8025);

        // Use the host and ports for testing
        System.out.println("Mailhog SMTP Host: " + smtpHost);
        System.out.println("Mailhog SMTP Port: " + smtpPort);
        System.out.println("Mailhog HTTP Port: " + httpPort);

        // Stop the container after testing
        mailhogContainer.stop();
    }
}




import javax.mail.*;
import javax.mail.internet.*;
import java.util.Properties;

public class MailhogEmailClient {
    public static void main(String[] args) throws MessagingException {
        // Mailhog container SMTP configuration
        String mailhogHost = "localhost"; // or the actual host if running remotely
        int mailhogPort = 1025;

        // Test email credentials
        String recipient = "recipient@example.com";

        // JavaMail API properties
        Properties properties = new Properties();
        properties.setProperty("mail.smtp.host", mailhogHost);
        properties.setProperty("mail.smtp.port", String.valueOf(mailhogPort));

        // Session object to authenticate the session
        Session session = Session.getInstance(properties);

        try {
            // Create a POP3 Store object and connect to the Mailhog container
            Store store = session.getStore("pop3");
            store.connect(mailhogHost, mailhogPort, null, null);

            // Get the Inbox folder
            Folder inbox = store.getFolder("INBOX");
            inbox.open(Folder.READ_ONLY);

            // Fetch messages from the Inbox
            Message[] messages = inbox.getMessages();
            System.out.println("Total messages in Inbox: " + messages.length);

            // Print each message's subject
            for (int i = 0; i < messages.length; i++) {
                Message message = messages[i];
                String subject = message.getSubject();
                System.out.println("Message " + (i + 1) + ": " + subject);
            }

            // Close the connection
            inbox.close(false);
            store.close();

        } catch (NoSuchProviderException e) {
            e.printStackTrace();
        } catch (MessagingException e) {
            e.printStackTrace();
        }
    }
}
